明示してなければ Excel 2007 (Windows) で確認。

※ここでは数式についてのコメントを → で表現しています。実際には数式にこのようなかたちでコメントを記述することは出来ません。

= リテラルと型 =
数式の中では数値はそのまま記述することができます。

<pre>
=300 → 300
=3.14 → 3.14
</pre>

文字列はダブルクォーテーション " で囲みます。文字列中にダブルクォーテーション を含める場合は "" と記述します。

<pre>
="文字" → 文字
="ダブルクォーテーション は""強調""や""引用""を意味する" → ダブルクォーテーション は"強調"や"引用"を意味する
</pre>

数値と文字はある程度自動的に変換されます。

<pre>
=1+"2" → 3 ※文字列が数値に変換される例
=FIND(2, "ABC123") → 5 ※数値が文字列に変換される例
</pre>

ただし、後述の比較演算子やMATCHなどでは変換しないまま比較されるので、数値として扱うか文字として扱うかきっちり決めておいたほうが安全です。

<pre>
=IF(1="1", "一致", "不一致") → 不一致
</pre>

ほかに、真か偽かの二値だけをとる真偽値があり、TRUE (真)、またはFALSE (偽) で示します。真偽値を数値として扱う場合、TRUEは1、FALSEは0になります。文字列として扱う場合、それぞれTRUE、FALSEという文字列になります。

<pre>
=(1=1) → TRUE
=(3>5) → FALSE
=TRUE+1 → 2
="TRUE is "&TRUE → TRUE is TRUE
</pre>

数値か文字列で、日付や時間を示すこともできます。数値として扱う場合は、1日を1とし、日付や日付を含む時刻は1900年1月1日00:00からの経過時間、日付を含まない時刻・時間は00:00からの経過時間で示されます。

<pre>
=("2010/9/8"+1) → 2010/9/9 ※セルの書式を「短い日付形式」にした場合
</pre>

= 関数、引数 =
関数は「関数名 (引数1, 引数2, …)」の形式で使用することができます。引数は省略可能なものもあります (カッコは省略できません。引数のない関数はPI()のように使います)。関数を実行すると何らかの値を返すので、そのままセルの値とすることもできますし、他の関数の引数にしたり、演算子で演算することもできます。

= エラー =
数式の結果がエラーになる場合があります。たとえば0で除算した場合は <tt>#DIV/0!</tt> というエラーになります。

<pre>
=1/0 → #DIV/0!
</pre>

エラーは数値でも文字列でもないので、関数や演算子による演算はほとんど行うことができません。エラーであるかどうか判定したい場合は <tt>ISERROR</tt> 関数を使用してください。

<pre>
=ISERROR(1/0) → TRUE
</pre>

エラーの意味と対処方法については下記ページを参照してください。

* [http://office.microsoft.com/ja-jp/excel-help/HP010066255.aspx#BMcorrect_an_error_value 数式エラーを確認して修正する - Excel - Microsoft Office]

= 算術演算子、比較演算子、論理演算 =
== + : 加算 ==
<pre>=5+3 → 8</pre>

== - : 減算 ==
<pre>=5-2 → 3</pre>

== * : 乗算 ==
<pre>=5*3 → 15</pre>

== / : 除算 ==
整数同士の除算でも、整数が返るとは限りません。
<pre>
=5/3 → 1.666667 ※セルの書式により表示される桁数は異なります
=ROUNDDOWN(5/3,0) → 1 ※小数点以下切り捨て
</pre>

== MOD(値, 除数) : 剰余 ==
<pre>=MOD(5,3) → 2</pre>

== ^ : 累乗 ==
<pre>=5^3 → 125</pre>

== & : 文字列の結合 ==
<pre>
="ABC"&"DEF" → ABCDEF
=100&200 → 100200
</pre>

== = : 両辺が等しければTRUE、それ以外はFALSE ==
等号2つ == じゃなくて、1つ = なので注意。

<pre>
=(1=1) → TRUE
=(1=2) → FALSE
=("string"="string") → TRUE
=("string"="String") → TRUE ※大文字小文字は区別されない
=("string"="ｓｔｒｉｎｇ") → FALSE ※半角全角は区別される
=(1="1") → FALSE
</pre>

== <> : 両辺が等しくなければTRUE、それ以外はFALSE ==
!= は使えません。

<pre>
=(1<>2) → TRUE
=(1<>1) → FALSE
=("string"<>"streich") → TRUE
</pre>

== > : 左辺が右辺より大きければTRUE、それ以外はFALSE ==
<pre>
=(2>1) → TRUE
=(1>1) → FALSE
</pre>

== < : 左辺が右辺より小さければTRUE、それ以外はFALSE ==
<pre>
=(1<2) → TRUE
=(1<1) → FALSE
</pre>

== >= : 左辺が右辺以上ならTRUE、それ以外はFALSE ==
<pre>
=(2>=1) → TRUE
=(1>=1) → TRUE
=(0>=1) → FALSE
</pre>

== <= : 左辺が右辺以下ならTRUE、それ以外はFALSE ==
<pre>
=(1<=2) → TRUE
=(1<=1) → TRUE
=(1<=0) → FALSE
</pre>

== AND(真偽式1, 真偽式2, …) : 論理積 ==
<pre>
=AND(TRUE,TRUE) → TRUE
=AND(TRUE,FALSE) → FALSE
=AND(FALSE,FALSE) → FALSE
=AND(3<5,5<7) → TRUE
</pre>

== OR(真偽式1, 真偽式2, …) : 論理和 ==
<pre>
=OR(TRUE,TRUE) → TRUE
=OR(TRUE,FALSE) → TRUE
=OR(FALSE,FALSE) → FALSE
=OR(3<0,3<5) → TRUE
</pre>

== NOT(真偽式) : 否定 ==
<pre>
=NOT(TRUE) → FALSE
=NOT(FALSE) → TRUE
=NOT(3<5) → FALSE
</pre>

= セル、セル範囲の参照 =
{|class="wikitable" style="float:left"
!style="width:3em;"|
!style="width:3em;"| A
!style="width:3em;"| B
!style="width:3em;"| C
!style="width:3em;"| D
!style="width:3em;"| E
!style="width:3em;"| F
!style="width:3em;"| G
|-
! 1
|style="background:#fada7a"| 
| 
|style="background:#d2da7a"| 
|style="background:#d2da7a"| 
| 
|style="background:#00b0f0"| 
| 
|-
! 2
|
|
|style="background:#d2da7a"|
|style="background:#d2da7a"|
|
|style="background:#00b0f0"|
|
|-
! 3
|
|
|
|
|
|style="background:#00b0f0"|
|
|-
! 4
|style="background:#9fb8cd"|
|style="background:#9fb8cd"|
|style="background:#9fb8cd"|
|
|
|style="background:#00b0f0"|
|
|-
! 5
|
|style="background:#9fb8cd"|
|style="background:#9fb8cd"|
|
|
|style="background:#00b0f0"|
|
|-
! 6
|
|
|style="background:#9fb8cd"|
|
|
|style="background:#00b0f0"|
|
|-
! 7
|
|
|
|
|
|style="background:#00b0f0"|
|
|-
! 8
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#7030a0"|
|style="background:#c00000"|
|-
! 9
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#c00000"|
|style="background:#7030a0"|
|style="background:#c00000"|
|-
! 10
|
|
|
|
|
|style="background:#00b0f0"|
|
|}

セルは列名と行番号で指定します。A列1行のセルなら<span style="background:#fada7a"> A1 </span>です。

四角形のセル範囲は左上端と右下端のセルをコロンでつないで指定します。たとえば<span style="background:#d2da7a"> C1:D2 </span>で4つのセルを含むセル範囲を示します。<span style="background:#00b0f0"> F:F </span>、<span style="background:#c00000"> 8:9 </span>のように、行番号/列名を省略すると、指定した列、行の全体を示します。

四角形でないセル範囲は、セルか、四角形のセル範囲をコンマでつないで指定します。<span style="background:#9fb8cd"> A4,B4:C5,C6 </span>で6つのセルを含むセル範囲を示します。

別シートにあるセルを参照するには、セル指定、四角形のセル範囲指定の前に「シート名!」を付与します。そのシートが別ブックにあるなら「[ブック名] シート名!」にします。

ただし、通常は数式の入力中にセルをクリックして参照するのがもっとも簡単です。四角形のセル範囲はドラッグで、コンマ区切りはCtrlを押しながらクリック/ドラッグで実現できます。

<br style="clear:both" />

= 絶対参照と相対参照 =
{|class="wikitable" style="float:left"
!style="width:3em;"| 
!style="width:3em;"| A
!style="width:3em;"| B
!style="width:3em;"| C
!style="width:3em;"| D
!style="width:3em;"| E
!style="width:3em;"| F
!style="width:3em;"| G
|-
! 1
|
|
|
|
|
|
|
|-
! 2
|
|style="background:#fada7a"| =X1
|style="background:#fada7a"| =Y1
|
|style="background:#d2da7a"| =$X1
|style="background:#d2da7a"| =$X1
|
|-
! 3
|
|style="background:#fada7a"| =X2
|style="background:#fada7a"| =Y2
|
|style="background:#d2da7a"| =$X2
|style="background:#d2da7a"| =$X2
|
|-
! 4
|
|
|
|
|
|
|
|-
! 5
|
|style="background:#9fb8cd"| =X$1
|style="background:#9fb8cd"| =Y$1
|
|style="background:#b88472"| =$X$1
|style="background:#b88472"| =$X$1
|
|-
! 6
|
|style="background:#9fb8cd"| =X$1
|style="background:#9fb8cd"| =Y$1
|
|style="background:#b88472"| =$X$1
|style="background:#b88472"| =$X$1
|
|-
! 7
|
|
|
|
|
|
|
|}

セル(セル範囲含む)の指定には絶対参照と相対参照の2種類があります。これはセル指定の列名、行番号の前に$があるかないかで指定します。$があれば絶対参照、なければ相対参照です。

この違いは、このセル参照を含むセルを別のセルにコピーしたときに現れます。

絶対参照の場合は、別のセルにコピーした際にも参照するセルは変化しません。相対参照の場合は、コピー元とコピー先のセルの位置関係に応じて参照するセルが変化します。

付表の例ではB2、E2、B5、E5にそれぞれさまざまな方法でX1への参照を書き、それぞれを横と下にコピーしたものです。$のついた部分は参照先が変化せず、ついていない部分はセルの位置に応じて参照先が変化しています。

絶対参照と相対参照の切り替えは、数式の編集時セル指定の部分にカーソルがある状態でF4キーを押すのが便利です。F4キーを押すたび、A10 → $A$10→ A$10 → $A10 → A10 ... のように変化します。

<br style="clear:both" />