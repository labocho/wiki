---
title: Excel の数式基礎
permalink: wiki/Excel_の数式基礎/
layout: wiki
---

明示してなければ Excel 2007 (Windows) で確認。

※ここでは数式についてのコメントを →
で表現しています。実際には数式にこのようなかたちでコメントを記述することは出来ません。

リテラルと型
============

数式の中では数値はそのまま記述することができます。

    =300 → 300
    =3.14 → 3.14

文字列はダブルクォーテーション "
で囲みます。文字列中にダブルクォーテーション を含める場合は ""
と記述します。

    ="文字" → 文字
    ="ダブルクォーテーション は""強調""や""引用""を意味する" → ダブルクォーテーション は"強調"や"引用"を意味する

数値と文字はある程度自動的に変換されます。

    =1+"2" → 3 ※文字列が数値に変換される例
    =FIND(2, "ABC123") → 5 ※数値が文字列に変換される例

ただし、後述の比較演算子やMATCHなどでは変換しないまま比較されるので、数値として扱うか文字として扱うかきっちり決めておいたほうが安全です。

    =IF(1="1", "一致", "不一致") → 不一致

ほかに、真か偽かの二値だけをとる真偽値があり、TRUE (真)、またはFALSE
(偽)
で示します。真偽値を数値として扱う場合、TRUEは1、FALSEは0になります。文字列として扱う場合、それぞれTRUE、FALSEという文字列になります。

    =(1=1) → TRUE
    =(3>5) → FALSE
    =TRUE+1 → 2
    ="TRUE is "&TRUE → TRUE is TRUE

数値か文字列で、日付や時間を示すこともできます。数値として扱う場合は、1日を1とし、日付や日付を含む時刻は1900年1月1日00:00からの経過時間、日付を含まない時刻・時間は00:00からの経過時間で示されます。

    =("2010/9/8"+1) → 2010/9/9 ※セルの書式を「短い日付形式」にした場合

関数、引数
==========

関数は「関数名 (引数1, 引数2,
…)」の形式で使用することができます。引数は省略可能なものもあります
(カッコは省略できません。引数のない関数はPI()のように使います)。関数を実行すると何らかの値を返すので、そのままセルの値とすることもできますし、他の関数の引数にしたり、演算子で演算することもできます。

エラー
======

数式の結果がエラーになる場合があります。たとえば0で除算した場合は
`#DIV/0!` というエラーになります。

    =1/0 → #DIV/0!

エラーは数値でも文字列でもないので、関数や演算子による演算はほとんど行うことができません。エラーであるかどうか判定したい場合は
`ISERROR` 関数を使用してください。

    =ISERROR(1/0) → TRUE

エラーの意味と対処方法については下記ページを参照してください。

-   [数式エラーを確認して修正する - Excel - Microsoft
    Office](http://office.microsoft.com/ja-jp/excel-help/HP010066255.aspx#BMcorrect_an_error_value)

算術演算子、比較演算子、論理演算
================================

+ : 加算
--------

    =5+3 → 8

- : 減算
--------

    =5-2 → 3

\* : 乗算
---------

    =5*3 → 15

/ : 除算
--------

整数同士の除算でも、整数が返るとは限りません。

    =5/3 → 1.666667 ※セルの書式により表示される桁数は異なります
    =ROUNDDOWN(5/3,0) → 1 ※小数点以下切り捨て

MOD(値, 除数) : 剰余
--------------------

    =MOD(5,3) → 2

\^ : 累乗
---------

    =5^3 → 125

& : 文字列の結合
----------------

    ="ABC"&"DEF" → ABCDEF
    =100&200 → 100200

== = : 両辺が等しければTRUE、それ以外はFALSE == 等号2つ ==
じゃなくて、1つ = なので注意。

    =(1=1) → TRU
    =(1=2) → FALSE
    =("string"="string") → TRUE
    =("string"="String") → TRUE ※大文字小文字は区別されない
    =("string"="ｓｔｒｉｎｇ") → FALSE ※半角全角は区別される
    =(1="1") → FALSE

\<\> : 両辺が等しくなければTRUE、それ以外はFALSE
------------------------------------------------

!= は使えません。

    =(1<>2) → TRUE
    =(1<>1) → FALSE
    =("string"<>"streich") → TRUE

\> : 左辺が右辺より大きければTRUE、それ以外はFALSE
--------------------------------------------------

    =(2>1) → TRUE
    =(1>1) → FALSE

\< : 左辺が右辺より小さければTRUE、それ以外はFALSE
--------------------------------------------------

    =(1<2) → TRUE
    =(1<1) → FALSE

== \>= : 左辺が右辺以上ならTRUE、それ以外はFALSE ==

    =(2>=1) → TRUE
    =(1>=1) → TRUE
    =(0>=1) → FALSE

== \<= : 左辺が右辺以下ならTRUE、それ以外はFALSE ==

    =(1<=2) → TRUE
    =(1<=1) → TRUE
    =(1<=0) → FALSE

AND(真偽式1, 真偽式2, …) : 論理積
---------------------------------

    =AND(TRUE,TRUE) → TRUE
    =AND(TRUE,FALSE) → FALSE
    =AND(FALSE,FALSE) → FALSE
    =AND(3<5,5<7) → TRUE

OR(真偽式1, 真偽式2, …) : 論理和
--------------------------------

    =OR(TRUE,TRUE) → TRUE
    =OR(TRUE,FALSE) → TRUE
    =OR(FALSE,FALSE) → FALSE
    =OR(3<0,3<5) → TRUE

NOT(真偽式) : 否定
------------------

    =NOT(TRUE) → FALSE
    =NOT(FALSE) → TRUE
    =NOT(3<5) → FALSE

 
